apexcharts_card_templates:
  meteo:
    apex_config:
      legend:
        show: false
      grid:
        show: false
      xaxis:
        axisBorder:
          show: false
    all_series_config:
      stroke_width: 1
decluttering_templates: !include "../decluttering_templates.yaml"
title: Dashboard Principal
views:
  ########################################
  # Apercu
  ########################################
  - title: Aperçu
    type: custom:grid-layout
    layout:
      grid-template-columns: 1fr 1fr 1fr 1fr
      grid-template-rows: auto auto auto auto
      grid-template-areas: |-
        "z z z z"
        "y y y y"
        "a a b b"
        "e f g h"
      place-content: stretch
    cards:   
      - type: horizontal-stack
        cards:    
          - type: custom:mushroom-person-card
            entity: person.cha
            icon_type: entity-picture
            badge_icon: |
              {% if is_state('input_select.cha', 'Home') %}
                mdi:home
              {% elif is_state(config.entity, 'away') or
                      is_state(config.entity, 'unavailable') %}
                mdi:map-marker-question-outline
              {% endif %}  
            badge_color: |-
              {% if is_state('input_select.cha', 'Home') %}
                green
              {% else %}
                red
              {% endif %}     
          - type: custom:mushroom-person-card 
            entity: person.kaeko
            icon_type: entity-picture
            badge_icon: |
              {% if is_state('input_select.cha', 'Home') %}
                mdi:home
              {% elif is_state(config.entity, 'away') or
                      is_state(config.entity, 'unavailable') %}
                mdi:map-marker-question-outline
              {% endif %}  
            badge_color: |-
              {% if is_state('input_select.cha', 'Home') %}
                green
              {% else %}
                red
              {% endif %}             
        view_layout:
          grid-area: z 
      - type: custom:hourly-weather
        entity: weather.forecast_maison
        num_segments: 24 # optional, defaults to 12
        name: Prochaines 24h # optional, defaults to "Hourly Weather"
        show_wind: true
        view_layout:
          place-self: center stretch
          grid-area: y  
        tap_action:
          action: navigate
          navigation_path: /preview-dashboard/2        
      - type: markdown
        title: Ecran large
        content: |
          {% for i in range(0, 5 ) %}
            <ha-alert alert-type="info">{{ states.sensor.ecran_large_rss.attributes.entries[i].title }}</br> [Lien]({{ states.sensor.ecran_large_rss.attributes.entries[i].link }})</ha-alert>
          {% endfor %}
            D'autres articles sur [Ecran Large](https://www.ecranlarge.com/)
        view_layout:
          place-self: stretch stretch
          grid-area: e              
      - type: markdown
        title: Journal du Geek
        content: |
          {% for i in range(0, 5 ) %}
            <ha-alert alert-type="info">{{ states.sensor.journal_du_geek_rss.attributes.entries[i].title }}</br> [Lien]({{ states.sensor.journal_du_geek_rss.attributes.entries[i].link }})</ha-alert>
          {% endfor %}
            D'autres articles sur [Journal du Geek](https://www.journaldugeek.com/)
        view_layout:
          place-self: cestretchnter stretch
          grid-area: f              
      - type: markdown
        title: Jeux vidéos
        content: |
          {% for i in range(0, 5 ) %}
            <ha-alert alert-type="info">{{ states.sensor.jeux_videos_rss.attributes.entries[i].title }}</br> [Lien]({{ states.sensor.jeux_videos_rss.attributes.entries[i].link }})</ha-alert>
          {% endfor %}
            D'autres articles sur [Jeux Vidéos](https://www.jeuxvideo.com/)                                    
        view_layout:
          place-self: stretch stretch
          grid-area: g  
      - type: markdown
        title: Les alexiens
        content: |
          {% for i in range(0, 5 ) %}
            <ha-alert alert-type="info">{{ states.sensor.les_alexiens_rss.attributes.entries[i].title }}</br> [Lien]({{ states.sensor.les_alexiens_rss.attributes.entries[i].link }})</ha-alert>
          {% endfor %}
            D'autres articles sur [Les alexiens](https://www.lesalexiens.fr/)
        view_layout:
          place-self: stretch stretch
          grid-area: h                          
  #################################################
  # Securité
  #################################################
  - title: Securité
    type: custom:grid-layout
    layout:
      grid-template-columns: 1fr 1fr 1fr
      grid-template-rows: auto auto auto
      grid-template-areas: |-
        "z z z"
        "a b c"
        "d e f"
      place-content: stretch
      mediaquery:
          grid-template-columns: 1fr
          grid-template-areas: |-
            "a"
            "b"
            "c"
            "d"
    cards:   
      - type: horizontal-stack
        cards:    
          - type: custom:mushroom-person-card
            entity: person.cha
            icon_type: entity-picture
            badge_icon: |
              {% if is_state('input_select.cha', 'Home') %}
                mdi:home
              {% elif is_state(config.entity, 'away') or
                      is_state(config.entity, 'unavailable') %}
                mdi:map-marker-question-outline
              {% endif %}  
            badge_color: |-
              {% if is_state('input_select.cha', 'Home') %}
                green
              {% else %}
                red
              {% endif %}     
          - type: custom:mushroom-person-card 
            entity: person.kaeko
            icon_type: entity-picture
            badge_icon: |
              {% if is_state('input_select.cha', 'Home') %}
                mdi:home
              {% elif is_state(config.entity, 'away') or
                      is_state(config.entity, 'unavailable') %}
                mdi:map-marker-question-outline
              {% endif %}  
            badge_color: |-
              {% if is_state('input_select.cha', 'Home') %}
                green
              {% else %}
                red
              {% endif %}             
        view_layout:
          grid-area: z       
      - type: grid
        square: false
        columns: 1
        cards:
          - type: picture-entity
            show_state: true
            show_name: true
            camera_view: live
            entity: camera.cam_hall_high
            camera_image: camera.cam_hall_high
            tap_action:
              action: none
          - type: entities
            entities:
              - entity: switch.cam_hall_privacy_mode
              - entity: select.cam_hall_recording_mode
              - entity: binary_sensor.cam_hall_is_dark
        view_layout:
          grid-area: a      
      - type: grid
        square: false
        columns: 1
        cards:
          - type: picture-entity
            show_state: true
            show_name: true
            camera_view: live
            entity: camera.cam_stairs_high
            camera_image: camera.cam_stairs_high
            tap_action:
              action: none
          - type: entities
            entities:
              - entity: switch.cam_stairs_privacy_mode
              - entity: select.cam_stairs_recording_mode
              - entity: binary_sensor.cam_stairs_is_dark
        view_layout:
          place-self: center stretch
          grid-area: b               
      - type: grid
        square: false
        columns: 1
        cards:
          - type: picture-entity
            show_state: true
            show_name: true
            camera_view: live
            entity: camera.cam_living_high
            camera_image: camera.cam_living_high
            tap_action:
              action: none
          - type: entities
            entities:
              - entity: switch.cam_living_privacy_mode
              - entity: select.cam_living_recording_mode
              - entity: binary_sensor.cam_living_is_dark     
        view_layout:
          grid-area: c   
      - type: entities
        show_header_toggle: false
        entities:
          - type: section
            label: Accès extérieur               
          - type: custom:decluttering-card
            template: door
            variables:
              - entity: binary_sensor.sonoff_a480085c50
              - name: Porte d'entrée       
          - type: custom:decluttering-card
            template: door
            variables:
              - entity: binary_sensor.sonoff_a48007e0ab
              - name: Porte Terrasse     
          - type: custom:decluttering-card
            template: door
            variables:
              - entity: binary_sensor.sonoff_a4800866c1
              - name: Fenêtre gauche    
        view_layout:
          grid-area: d                                                       
  #################################################
  # Meteo
  #################################################
  - title: Meteo          
    type: custom:grid-layout
    layout:
      grid-template-columns: repeat(4, 1fr)
      grid-template-areas: |-
        "z z z z"
        "y y y y"
        "a b b b"
        "c b b b"
        "d e f g"
      place-content: stretch
    cards: 
    - type: custom:hourly-weather
      entity: weather.forecast_maison
      num_segments: 24 # optional, defaults to 12
      name: Prochaines 24h # optional, defaults to "Hourly Weather"
      show_wind: true
      view_layout:
        place-self: center stretch
        grid-area: z
    - type: horizontal-stack
      cards:
        - type: entities
          entities:
            - entity: sensor.next_sunrise
              name: Lever du soleil
            - entity: sensor.next_sunset
              name: Coucher du soleil
        - type: entities
          entities:
            - entity: sensor.ws2900_v2_02_01_max_daily_gust
              name: Rafale maximale 
            - entity: sensor.ws2900_v2_02_01_total_rain
              name: Pluie totale    
      view_layout:
        grid-area: y
    - type: custom:weather-chart-card
      entity: weather.forecast_maison
      show_main: false
      show_current_condition: false
      show_attributes: false
      animated_icons: true
      units:
        speed: km/h 
      view_layout:
        place-self: center stretch
        grid-area: a             
    - type: iframe
      aspect_ratio: 50%
      url: "https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=7&overlay=wind&product=ecmwf&level=surface&lat=50.17&lon=4.329&pressure=true&message=true"              
      view_layout:
        place-self: center stretch
        grid-area: b  
    - type: custom:apexcharts-card
      config_templates:
        - meteo
      header:
        show: true
        show_states: true
        colorize_states: true
      graph_span: 36h
      all_series_config:
        stroke_width: 1
      series:
        - entity: sensor.ws2900_v2_02_01_outdoor_temperature
          name: Temperature
          show:
            extremas: true
        - entity: sensor.ws2900_v2_02_01_feels_like_temperature
          name: Ressentie
        - entity: sensor.ws2900_v2_02_01_windchill
          name: Refroidissement Eolien
        - entity: sensor.ws2900_v2_02_01_dewpoint
          name: Rosée
      view_layout:
        grid-area: c
    - type: custom:apexcharts-card
      config_templates:
        - meteo
      header:
        show: true
        title: Vent
        show_states: true
        colorize_states: true
      graph_span: 36h
      all_series_config:
        stroke_width: 1
        show:
          extremas: max
      series:
        - entity: sensor.ws2900_v2_02_01_wind_speed
          name: Vitesse
        - entity: sensor.ws2900_v2_02_01_wind_gust
          name: Rafale
          opacity: 0.2
          type: area
      view_layout:
        grid-area: d            
    - type: custom:apexcharts-card
      config_templates:
        - meteo
      header:
        show: true
        title: Pluie
        show_states: true
        colorize_states: true
      graph_span: 1d
      all_series_config:
        stroke_width: 1
        show:
          extremas: max
      yaxis:
        - id: rate
        - id: total
          opposite: true
      series:
        - entity: sensor.ws2900_v2_02_01_rain_rate
          name: Pluviométrie
          type: column
          stroke_width: 2
          yaxis_id: rate
          color: rebeccapurple
        - entity: sensor.ws2900_v2_02_01_total_rain
          yaxis_id: total
      view_layout:
        grid-area: e            
    - type: custom:apexcharts-card
      config_templates:
        - meteo
      header:
        show: true
        title: Pression
        show_states: true
        colorize_states: true
      graph_span: 2d
      all_series_config:
        stroke_width: 1
        show:
          extremas: true
      series:
        - entity: sensor.ws2900_v2_02_01_relative_pressure
          name: Pression
      view_layout:
        grid-area: f            
    - type: custom:apexcharts-card
      config_templates:
        - meteo
      header:
        show: true
        title: Humidité
        show_states: true
        colorize_states: true
      graph_span: 1d
      all_series_config:
        stroke_width: 1
        show:
          extremas: true
      series:
        - entity: sensor.ws2900_v2_02_01_humidity
          name: Humidité
      view_layout:
        grid-area: g            

        
